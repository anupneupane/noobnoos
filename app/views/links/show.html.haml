.row.mylinkspace
  .small-2.columns.span-link-vote
    = link_to vote_up_link_path(@link), :method => :post do
      %i.icon-caret-up.icon-4x.myvotearrow
    %div
      %h1.votes=@link.plusminus
    = link_to vote_down_link_path(@link), :method => :post do
      %i.icon-caret-down.icon-4x.myvotearrow
  .link
    .small-5.columns.mythumbnail
      =link_to image_tag(@link.thumbnail, class: "thumbnail mythumbnail"), @link.url
    .small-17.columns
      %h4
        %strong.linktitle=link_to @link.title, @link.url     
      %p=@link.description
      %p.aboutlink
        -gravatar_hash = Digest::MD5.hexdigest(@link.user.email.downcase)
        =image_tag("http://www.gravatar.com/avatar/" + gravatar_hash, class: "userthumb")
        %span.blue
          =@link.user.username
        | 
        %i.icon-calendar
        -localtime = @link.created_at-5.hours
        = localtime.strftime("%D %I:%M %p")
        - if current_user == @link.user
          |
          = link_to "Edit Link", edit_link_path(@link)
          |
          = link_to "Delete Link", @link, confirm: "Are you sure?",method: "delete"
          |
          = show_favorite_star(current_user, 
            @link)

%div.comments
  %h4.comment-header Comments:
  - @link.comments.sort_by {|comment| comment.plusminus}.reverse.each do |comment|
    -if comment.message !=nil
      .comment.row
        .large-2.columns.span-comment-vote
          %div
            = link_to raw('<i class="icon-caret-up icon-2x myvotearrow"></i>'), vote_up_link_comment_path(@link,comment), :method => :post
          %div
            %h4.votes=comment.plusminus
          %div
            = link_to raw('<i class="icon-caret-down icon-2x myvotearrow"></i>'), vote_down_link_comment_path(@link, comment), :method => :post
          
        .large-22.columns.comment-content    
          %p
            %span.user
              %strong="User:" if comment.user
              = comment.user.username if comment.user
            %span.date
              %strong="Date:" if comment.created_at
              - localcommenttime = comment.created_at-5.hours if comment.created_at
              = localcommenttime.strftime("%D %I:%M %p") if comment.created_at
          %div
            %p= comment.message
          

.myform
  .row
    .large-8.offset-8.columns
      = form_for [@link, @comment] do |f|
        -if @comment.errors.any?
          #error_explanation
            %h2= pluralize(@comment.errors.count, "error") + "prohibited this comment from being saved:"
            %ul
              - @comment.errors.full_messages.each do |msg|
                %li= msg
        %div= f.text_area :message, :placeholder => "Add a comment", :autofocus => true, rows: "10", class: "field span4"
        %div= f.submit "Add Comment", :class => 'button small'